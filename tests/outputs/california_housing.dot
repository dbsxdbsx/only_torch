digraph Model {
    rankdir=TB;
    node [fontname="Microsoft YaHei,SimHei,Arial"];
    edge [fontname="Microsoft YaHei,SimHei,Arial"];

    subgraph cluster_fc1 {
        label=<<B>fc1</B><BR/><FONT POINT-SIZE="9">Linear: 8→128</FONT>>;
        style=filled;
        fillcolor="#E3F2FD80";
        fontname="Microsoft YaHei,SimHei,Arial";
        fontsize=11;
        margin=12;
        "3" [label=<fc1_W<BR/><B>Parameter</B><BR/>[8, 128]<BR/>(1,024 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
        "4" [label=<fc1_b<BR/><B>Parameter</B><BR/>[1, 128]<BR/>(128 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
        "11" [label=<mat_mul_1<BR/><B>MatMul</B><BR/>[256, 128]> shape=box style="filled,rounded" fillcolor="#FFFDE7" fontsize=10];
        "12" [label=<add_1<BR/><B>Add</B><BR/>[256, 128]> shape=box style="filled,rounded" fillcolor="#FFFDE7" fontsize=10];
    }

    subgraph cluster_fc2 {
        label=<<B>fc2</B><BR/><FONT POINT-SIZE="9">Linear: 128→64</FONT>>;
        style=filled;
        fillcolor="#E8F5E980";
        fontname="Microsoft YaHei,SimHei,Arial";
        fontsize=11;
        margin=12;
        "5" [label=<fc2_W<BR/><B>Parameter</B><BR/>[128, 64]<BR/>(8,192 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
        "6" [label=<fc2_b<BR/><B>Parameter</B><BR/>[1, 64]<BR/>(64 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
        "14" [label=<mat_mul_2<BR/><B>MatMul</B><BR/>[256, 64]> shape=box style="filled,rounded" fillcolor="#FFFDE7" fontsize=10];
        "15" [label=<add_2<BR/><B>Add</B><BR/>[256, 64]> shape=box style="filled,rounded" fillcolor="#FFFDE7" fontsize=10];
    }

    subgraph cluster_fc3 {
        label=<<B>fc3</B><BR/><FONT POINT-SIZE="9">Linear: 64→32</FONT>>;
        style=filled;
        fillcolor="#FFF3E080";
        fontname="Microsoft YaHei,SimHei,Arial";
        fontsize=11;
        margin=12;
        "7" [label=<fc3_W<BR/><B>Parameter</B><BR/>[64, 32]<BR/>(2,048 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
        "8" [label=<fc3_b<BR/><B>Parameter</B><BR/>[1, 32]<BR/>(32 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
        "17" [label=<mat_mul_3<BR/><B>MatMul</B><BR/>[256, 32]> shape=box style="filled,rounded" fillcolor="#FFFDE7" fontsize=10];
        "18" [label=<add_3<BR/><B>Add</B><BR/>[256, 32]> shape=box style="filled,rounded" fillcolor="#FFFDE7" fontsize=10];
    }

    subgraph cluster_fc4 {
        label=<<B>fc4</B><BR/><FONT POINT-SIZE="9">Linear: 32→1</FONT>>;
        style=filled;
        fillcolor="#F3E5F580";
        fontname="Microsoft YaHei,SimHei,Arial";
        fontsize=11;
        margin=12;
        "9" [label=<fc4_W<BR/><B>Parameter</B><BR/>[32, 1]<BR/>(32 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
        "10" [label=<fc4_b<BR/><B>Parameter</B><BR/>[1, 1]<BR/>(1 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
        "20" [label=<mat_mul_4<BR/><B>MatMul</B><BR/>[256, 1]> shape=box style="filled,rounded" fillcolor="#FFFDE7" fontsize=10];
        "21" [label=<add_4<BR/><B>Add</B><BR/>[256, 1]> shape=box style="filled,rounded" fillcolor="#FFFDE7" fontsize=10];
    }

    "1" [label=<input_1<BR/><B>Input</B><BR/>[256, 8]> shape=ellipse style=filled fillcolor="#E3F2FD" fontsize=10];
    "2" [label=<input_2<BR/><B>Input</B><BR/>[256, 1]> shape=ellipse style=filled fillcolor="#E3F2FD" fontsize=10];
    "13" [label=<softplus_1<BR/><B>SoftPlus</B><BR/>[256, 128]> shape=diamond style=filled fillcolor="#FFF3E0" fontsize=10];
    "16" [label=<softplus_2<BR/><B>SoftPlus</B><BR/>[256, 64]> shape=diamond style=filled fillcolor="#FFF3E0" fontsize=10];
    "19" [label=<softplus_3<BR/><B>SoftPlus</B><BR/>[256, 32]> shape=diamond style=filled fillcolor="#FFF3E0" fontsize=10];
    "22" [label=<mse_loss_1<BR/><B>MSELoss</B><BR/>[1, 1]> shape=doubleoctagon style=filled fillcolor="#FFEBEE" fontsize=10];

    "1" -> "11";
    "3" -> "11";
    "11" -> "12";
    "4" -> "12";
    "12" -> "13";
    "13" -> "14";
    "5" -> "14";
    "14" -> "15";
    "6" -> "15";
    "15" -> "16";
    "16" -> "17";
    "7" -> "17";
    "17" -> "18";
    "8" -> "18";
    "18" -> "19";
    "19" -> "20";
    "9" -> "20";
    "20" -> "21";
    "10" -> "21";
    "21" -> "22";
    "2" -> "22";
}
