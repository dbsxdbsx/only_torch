digraph Model {
    rankdir=TB;
    node [fontname="Microsoft YaHei,SimHei,Arial"];
    edge [fontname="Microsoft YaHei,SimHei,Arial"];

    "1" [label=<input<BR/><B>Input</B><BR/>[16, 1]> shape=ellipse style=filled fillcolor="#E3F2FD" fontsize=10];
    "2" [label=<mask<BR/><B>Input</B><BR/>[16, 8]> shape=ellipse style=filled fillcolor="#E3F2FD" fontsize=10];
    "3" [label=<neg_one<BR/><B>Parameter</B><BR/>[1, 1]<BR/>(1 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
    "4" [label=<h_prev<BR/><B>State</B><BR/>[16, 8]> shape=cylinder style=filled fillcolor="#FFE0B2" fontsize=10];
    "5" [label=<w_ih<BR/><B>Parameter</B><BR/>[1, 8]<BR/>(8 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
    "6" [label=<w_hh<BR/><B>Parameter</B><BR/>[8, 8]<BR/>(64 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
    "7" [label=<input_contrib<BR/><B>MatMul</B><BR/>[16, 8]> shape=box style="filled,rounded" fillcolor="#FFFDE7" fontsize=10];
    "8" [label=<hidden_contrib<BR/><B>MatMul</B><BR/>[16, 8]> shape=box style="filled,rounded" fillcolor="#FFFDE7" fontsize=10];
    "9" [label=<pre_hidden<BR/><B>Add</B><BR/>[16, 8]> shape=box style="filled,rounded" fillcolor="#FFFDE7" fontsize=10];
    "10" [label=<h_tilde<BR/><B>Tanh</B><BR/>[16, 8]> shape=diamond style=filled fillcolor="#FFF3E0" fontsize=10];
    "11" [label=<neg_h_prev<BR/><B>ScalarMultiply</B><BR/>[16, 8]> shape=box style="filled,rounded" fillcolor="#FFFDE7" fontsize=10];
    "12" [label=<delta<BR/><B>Add</B><BR/>[16, 8]> shape=box style="filled,rounded" fillcolor="#FFFDE7" fontsize=10];
    "13" [label=<masked_delta<BR/><B>Multiply</B><BR/>[16, 8]> shape=box style="filled,rounded" fillcolor="#FFFDE7" fontsize=10];
    "14" [label=<hidden<BR/><B>Add</B><BR/>[16, 8]> shape=box style="filled,rounded" fillcolor="#FFFDE7" fontsize=10];
    "15" [label=<w_ho<BR/><B>Parameter</B><BR/>[8, 1]<BR/>(8 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
    "16" [label=<pre_output<BR/><B>MatMul</B><BR/>[16, 1]> shape=box style="filled,rounded" fillcolor="#FFFDE7" fontsize=10];
    "17" [label=<output<BR/><B>Sigmoid</B><BR/>[16, 1]> shape=diamond style=filled fillcolor="#FFF3E0" fontsize=10];
    "18" [label=<target<BR/><B>Input</B><BR/>[16, 1]> shape=ellipse style=filled fillcolor="#E3F2FD" fontsize=10];
    "19" [label=<loss<BR/><B>MSELoss</B><BR/>[1, 1]> shape=doubleoctagon style=filled fillcolor="#FFEBEE" fontsize=10];

    "1" -> "7";
    "5" -> "7";
    "4" -> "8";
    "6" -> "8";
    "7" -> "9";
    "8" -> "9";
    "9" -> "10";
    "3" -> "11";
    "4" -> "11";
    "10" -> "12";
    "11" -> "12";
    "2" -> "13";
    "12" -> "13";
    "4" -> "14";
    "13" -> "14";
    "14" -> "16";
    "15" -> "16";
    "16" -> "17";
    "17" -> "19";
    "18" -> "19";
    "14" -> "4" [style=dashed color="#E67E22" label="t-1" fontcolor="#E67E22"];
}
