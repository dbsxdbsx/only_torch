digraph Model {
    rankdir=TB;
    node [fontname="Microsoft YaHei,SimHei,Arial"];
    edge [fontname="Microsoft YaHei,SimHei,Arial"];

    "1" [label=<input_1<BR/><B>Input</B><BR/>[256, 784]> shape=ellipse style=filled fillcolor="#E3F2FD" fontsize=10];
    "2" [label=<input_2<BR/><B>Input</B><BR/>[256, 64]> shape=ellipse style=filled fillcolor="#E3F2FD" fontsize=10];
    "3" [label=<input_3<BR/><B>Input</B><BR/>[256, 1]> shape=ellipse style=filled fillcolor="#E3F2FD" fontsize=10];
    "4" [label=<g_w1<BR/><B>Parameter</B><BR/>[64, 128]<BR/>(8,192 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
    "5" [label=<g_b1<BR/><B>Parameter</B><BR/>[1, 128]<BR/>(128 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
    "6" [label=<mat_mul_1<BR/><B>MatMul</B><BR/>[256, 128]> shape=box style="filled,rounded" fillcolor="#FFFDE7" fontsize=10];
    "7" [label=<mat_mul_2<BR/><B>MatMul</B><BR/>[256, 128]> shape=box style="filled,rounded" fillcolor="#FFFDE7" fontsize=10];
    "8" [label=<add_1<BR/><B>Add</B><BR/>[256, 128]> shape=box style="filled,rounded" fillcolor="#FFFDE7" fontsize=10];
    "9" [label=<leaky_relu_1<BR/><B>LeakyReLU</B><BR/>[256, 128]<BR/>α=0.2> shape=diamond style=filled fillcolor="#FFF3E0" fontsize=10];
    "10" [label=<g_w2<BR/><B>Parameter</B><BR/>[128, 784]<BR/>(100,352 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
    "11" [label=<g_b2<BR/><B>Parameter</B><BR/>[1, 784]<BR/>(784 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
    "12" [label=<mat_mul_3<BR/><B>MatMul</B><BR/>[256, 784]> shape=box style="filled,rounded" fillcolor="#FFFDE7" fontsize=10];
    "13" [label=<mat_mul_4<BR/><B>MatMul</B><BR/>[256, 784]> shape=box style="filled,rounded" fillcolor="#FFFDE7" fontsize=10];
    "14" [label=<add_2<BR/><B>Add</B><BR/>[256, 784]> shape=box style="filled,rounded" fillcolor="#FFFDE7" fontsize=10];
    "15" [label=<sigmoid_1<BR/><B>Sigmoid</B><BR/>[256, 784]> shape=diamond style=filled fillcolor="#FFF3E0" fontsize=10];
    "16" [label=<d_w1<BR/><B>Parameter</B><BR/>[784, 128]<BR/>(100,352 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
    "17" [label=<d_b1<BR/><B>Parameter</B><BR/>[1, 128]<BR/>(128 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
    "18" [label=<mat_mul_5<BR/><B>MatMul</B><BR/>[256, 128]> shape=box style="filled,rounded" fillcolor="#FFFDE7" fontsize=10];
    "19" [label=<mat_mul_6<BR/><B>MatMul</B><BR/>[256, 128]> shape=box style="filled,rounded" fillcolor="#FFFDE7" fontsize=10];
    "20" [label=<add_3<BR/><B>Add</B><BR/>[256, 128]> shape=box style="filled,rounded" fillcolor="#FFFDE7" fontsize=10];
    "21" [label=<leaky_relu_2<BR/><B>LeakyReLU</B><BR/>[256, 128]<BR/>α=0.2> shape=diamond style=filled fillcolor="#FFF3E0" fontsize=10];
    "22" [label=<d_w2<BR/><B>Parameter</B><BR/>[128, 1]<BR/>(128 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
    "23" [label=<d_b2<BR/><B>Parameter</B><BR/>[1, 1]<BR/>(1 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
    "24" [label=<mat_mul_7<BR/><B>MatMul</B><BR/>[256, 1]> shape=box style="filled,rounded" fillcolor="#FFFDE7" fontsize=10];
    "25" [label=<mat_mul_8<BR/><B>MatMul</B><BR/>[256, 1]> shape=box style="filled,rounded" fillcolor="#FFFDE7" fontsize=10];
    "26" [label=<add_4<BR/><B>Add</B><BR/>[256, 1]> shape=box style="filled,rounded" fillcolor="#FFFDE7" fontsize=10];
    "27" [label=<sigmoid_2<BR/><B>Sigmoid</B><BR/>[256, 1]> shape=diamond style=filled fillcolor="#FFF3E0" fontsize=10];
    "28" [label=<mat_mul_9<BR/><B>MatMul</B><BR/>[256, 128]> shape=box style="filled,rounded" fillcolor="#FFFDE7" fontsize=10];
    "29" [label=<mat_mul_10<BR/><B>MatMul</B><BR/>[256, 128]> shape=box style="filled,rounded" fillcolor="#FFFDE7" fontsize=10];
    "30" [label=<add_5<BR/><B>Add</B><BR/>[256, 128]> shape=box style="filled,rounded" fillcolor="#FFFDE7" fontsize=10];
    "31" [label=<leaky_relu_3<BR/><B>LeakyReLU</B><BR/>[256, 128]<BR/>α=0.2> shape=diamond style=filled fillcolor="#FFF3E0" fontsize=10];
    "32" [label=<mat_mul_11<BR/><B>MatMul</B><BR/>[256, 1]> shape=box style="filled,rounded" fillcolor="#FFFDE7" fontsize=10];
    "33" [label=<mat_mul_12<BR/><B>MatMul</B><BR/>[256, 1]> shape=box style="filled,rounded" fillcolor="#FFFDE7" fontsize=10];
    "34" [label=<add_6<BR/><B>Add</B><BR/>[256, 1]> shape=box style="filled,rounded" fillcolor="#FFFDE7" fontsize=10];
    "35" [label=<sigmoid_3<BR/><B>Sigmoid</B><BR/>[256, 1]> shape=diamond style=filled fillcolor="#FFF3E0" fontsize=10];
    "36" [label=<input_4<BR/><B>Input</B><BR/>[256, 1]> shape=ellipse style=filled fillcolor="#E3F2FD" fontsize=10];
    "37" [label=<input_5<BR/><B>Input</B><BR/>[256, 1]> shape=ellipse style=filled fillcolor="#E3F2FD" fontsize=10];
    "38" [label=<mse_loss_1<BR/><B>MSELoss</B><BR/>[1, 1]> shape=doubleoctagon style=filled fillcolor="#FFEBEE" fontsize=10];
    "39" [label=<mse_loss_2<BR/><B>MSELoss</B><BR/>[1, 1]> shape=doubleoctagon style=filled fillcolor="#FFEBEE" fontsize=10];
    "40" [label=<mse_loss_3<BR/><B>MSELoss</B><BR/>[1, 1]> shape=doubleoctagon style=filled fillcolor="#FFEBEE" fontsize=10];

    "2" -> "6";
    "4" -> "6";
    "3" -> "7";
    "5" -> "7";
    "6" -> "8";
    "7" -> "8";
    "8" -> "9";
    "9" -> "12";
    "10" -> "12";
    "3" -> "13";
    "11" -> "13";
    "12" -> "14";
    "13" -> "14";
    "14" -> "15";
    "1" -> "18";
    "16" -> "18";
    "3" -> "19";
    "17" -> "19";
    "18" -> "20";
    "19" -> "20";
    "20" -> "21";
    "21" -> "24";
    "22" -> "24";
    "3" -> "25";
    "23" -> "25";
    "24" -> "26";
    "25" -> "26";
    "26" -> "27";
    "15" -> "28";
    "16" -> "28";
    "3" -> "29";
    "17" -> "29";
    "28" -> "30";
    "29" -> "30";
    "30" -> "31";
    "31" -> "32";
    "22" -> "32";
    "3" -> "33";
    "23" -> "33";
    "32" -> "34";
    "33" -> "34";
    "34" -> "35";
    "27" -> "38";
    "36" -> "38";
    "35" -> "39";
    "37" -> "39";
    "35" -> "40";
    "36" -> "40";
}
