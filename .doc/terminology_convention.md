# 术语规范

本文档定义了 only_torch 项目中使用的术语规范，确保代码、注释和文档中的表达一致性。

---

## 一、核心数学概念

### 1.1 维度与张量体系

| 术语            | 英文                        | 定义                          | 与 PyTorch 对应    | 示例                            |
| --------------- | --------------------------- | ----------------------------- | ------------------ | ------------------------------- |
| **维数(ndim)**  | ndim / number of dimensions | 张量有几个轴，即 shape 的长度 | `ndim` / `dim()`   | 标量 0 维，向量 1 维，矩阵 2 维 |
| **维度(dim)**   | dimension / dim             | 指定某个轴（用于函数参数）    | `dim=0`            | `sum(dim=0)`沿第 0 维求和       |
| **形状(shape)** | shape                       | 各维大小组成的元组            | `shape` / `size()` | `[2, 3, 4]`表示 2×3×4 的张量    |

> **关于"阶(rank)"**：在通用数学语境中，"阶"和"维"常可互换使用（如"3 维张量"与"3 阶张量"含义相同）。但本项目为与 PyTorch 等主流库保持一致，**统一使用"维度(dimension/dim)"相关术语**，避免使用"阶(rank)"——因其在线性代数中另有含义（矩阵的秩）。

### 1.2 张量类型

| 术语             | 英文   | 维数 | shape 示例 | 说明                   |
| ---------------- | ------ | ---- | ---------- | ---------------------- |
| **标量(scalar)** | scalar | 0    | `[]`       | 单个数值，无维度       |
| **向量(vector)** | vector | 1    | `[n]`      | 1 维数组               |
| **矩阵(matrix)** | matrix | 2    | `[m, n]`   | 2 维数组，m 行 n 列    |
| **张量(tensor)** | tensor | ≥0   | 任意       | 泛指，包含以上所有类型 |

> **注**：本项目中"张量"既可特指高维(≥3)数据结构，也可作为所有类型的统称，具体含义视上下文而定。

---

## 二、API 命名规范

### 2.1 维度相关 API

为与 PyTorch 保持一致，本项目 API 命名遵循以下规范：

| 概念         | API 命名                  | 参数命名 | 示例                                |
| ------------ | ------------------------- | -------- | ----------------------------------- |
| 获取维数     | `ndim()` 或 `dimension()` | —        | `tensor.ndim()` → 返回轴的数量      |
| 指定哪个轴   | —                         | `dim`    | `unsqueeze(dim=0)`                  |
| 获取某维大小 | `shape()[i]`              | —        | `tensor.shape()[0]` → 第 0 维的大小 |

### 2.2 符合规范的 API

所有公开 API 均已统一使用 `dim` 作为维度参数名：

- `shuffle(dim)` ✅
- `shuffle_mut(dim)` ✅
- `shuffle_mut_seeded(dim, seed)` ✅
- `unsqueeze(dim)` ✅
- `unsqueeze_mut(dim)` ✅
- `transpose_dims(dim1, dim2)` ✅

---

## 三、数字表达规范

### 3.1 阿拉伯数字 vs 中文数字

| 场景            | 推荐写法   | 示例                   | 理由                 |
| --------------- | ---------- | ---------------------- | -------------------- |
| **技术描述**    | 阿拉伯数字 | `2维张量`、`第0维`     | 简洁、与代码风格一致 |
| **计数/序数**   | 阿拉伯数字 | `第1个`、`共3次`       | 精确、易读           |
| **习惯用语**    | 中文数字   | `一般来说`、`二者之间` | 保持中文语感         |
| **大约/模糊数** | 中文数字   | `十几个`、`几百次`     | 符合中文表达习惯     |

**简化原则**：技术文档中优先使用阿拉伯数字，除非是固定短语或习惯用语。

---

## 四、中英文混用规范

### 4.1 代码标识符

| 类型                 | 语言     | 示例                             |
| -------------------- | -------- | -------------------------------- |
| 变量名/函数名/类型名 | 英文     | `node_id`, `forward()`, `Tensor` |
| 注释说明             | 中文为主 | `// 计算雅可比矩阵`              |
| 错误信息             | 中文     | `"输入节点不应该有梯度"`         |

### 4.2 文档术语

| 场景               | 格式         | 示例                          |
| ------------------ | ------------ | ----------------------------- |
| 首次出现的专业术语 | 中文(英文)   | `雅可比矩阵(Jacobian matrix)` |
| 后续引用           | 中文         | `雅可比矩阵`                  |
| 代码中的概念       | 保持代码原样 | `NodeHandle`、`Graph`         |

### 4.3 常用术语对照

| 中文     | 英文            | 本项目首选 | 备注                                 |
| -------- | --------------- | ---------- | ------------------------------------ |
| 维度     | dimension / dim | 维度       | 统一使用，避免"阶"                   |
| 维数     | ndim            | 维数       | 张量有几个轴                         |
| 值       | value           | 值         | 节点的计算结果                       |
| 变量     | variable        | 变量       | 可训练参数节点                       |
| 节点     | node            | 节点       | 计算图中的节点                       |
| 句柄     | handle          | —          | 代码中用`NodeHandle`，注释中说"节点" |
| 梯度     | gradient        | 梯度       |                                      |
| 雅可比   | Jacobian        | 雅可比     | 雅可比矩阵                           |
| 前向传播 | forward pass    | 前向传播   |                                      |
| 反向传播 | backward pass   | 反向传播   |                                      |
| 损失     | loss            | 损失       |                                      |
| 优化器   | optimizer       | 优化器     |                                      |

---

## 五、标点规范

| 项目     | 规范         | 示例                 |
| -------- | ------------ | -------------------- |
| 中文逗号 | `，`后无空格 | `输入节点，输出节点` |
| 英文逗号 | `, `后加空格 | `input, output`      |
| 代码引用 | 用反引号包裹 | `` `NodeHandle` ``   |

---

## 六、更新记录

| 日期       | 内容                                                                  |
| ---------- | --------------------------------------------------------------------- |
| 2025-12-21 | 初始版本，定义核心术语规范                                            |
| 2025-12-21 | 统一使用"维度(dim)"术语，避免"阶(rank)"；明确 API 命名规范            |
| 2025-12-21 | 完成 `shuffle` 系列 API 重构，参数 `axis` 统一改为 `dim`，符合规范 ✅ |
