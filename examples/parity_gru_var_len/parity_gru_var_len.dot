digraph Model {
    rankdir=TB;
    newrank=true;
    splines=polyline;
    node [fontname="Microsoft YaHei,SimHei,Arial"];
    edge [fontname="Microsoft YaHei,SimHei,Arial"];

    subgraph cluster_ParityGRU {
        label=<<B>ParityGRU</B><BR/><FONT POINT-SIZE="9">Model: 255 nodes</FONT>>;
        style=filled;
        fillcolor="#FFECB340";
        fontname="Microsoft YaHei,SimHei,Arial";
        fontsize=11;
        margin=12;
        subgraph cluster_ParityGRU_fc {
            label=<<B>fc</B><BR/><FONT POINT-SIZE="8">Linear: [?, 16] → [?, 2]</FONT>>;
            style=filled;
            fillcolor="#E3F2FD80";
            fontname="Microsoft YaHei,SimHei,Arial";
            fontsize=10;
            margin=8;
            "10" [label=<fc_W<BR/><B>Parameter</B><BR/>[16, 2]<BR/>(32 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
            "11" [label=<fc_b<BR/><B>Parameter</B><BR/>[1, 2]<BR/>(2 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
            "1502" [label=<mat_mul <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>MatMul</B><BR/>[?, 2]> shape=box style="filled,rounded" fillcolor="#FFFDE7" peripheries=2 fontsize=10];
            "1503" [label=<add <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>Add</B><BR/>[?, 2]> shape=box style="filled,rounded" fillcolor="#FFFDE7" peripheries=2 fontsize=10];
        }
        subgraph cluster_ParityGRU_gru {
            label=<<B>gru</B><BR/><FONT POINT-SIZE="8">GRU: [?, 1] → [?, 16]</FONT>>;
            style="filled,bold";
            peripheries=3;
            penwidth=2;
            fillcolor="#E8F5E980";
            fontname="Microsoft YaHei,SimHei,Arial";
            fontsize=10;
            margin=8;
            "1" [label=<gru_W_ir<BR/><B>Parameter</B><BR/>[1, 16]<BR/>(16 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
            "2" [label=<gru_W_hr<BR/><B>Parameter</B><BR/>[16, 16]<BR/>(256 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
            "3" [label=<gru_b_r<BR/><B>Parameter</B><BR/>[1, 16]<BR/>(16 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
            "4" [label=<gru_W_iz<BR/><B>Parameter</B><BR/>[1, 16]<BR/>(16 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
            "5" [label=<gru_W_hz<BR/><B>Parameter</B><BR/>[16, 16]<BR/>(256 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
            "6" [label=<gru_b_z<BR/><B>Parameter</B><BR/>[1, 16]<BR/>(16 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
            "7" [label=<gru_W_in<BR/><B>Parameter</B><BR/>[1, 16]<BR/>(16 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
            "8" [label=<gru_W_hn<BR/><B>Parameter</B><BR/>[16, 16]<BR/>(256 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
            "9" [label=<gru_b_n<BR/><B>Parameter</B><BR/>[1, 16]<BR/>(16 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
            "1261" [label=<zeros_like <FONT COLOR="#E67E22">×1</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>ZerosLike</B><BR/>[?, 16]> shape=box style="filled,rounded,dashed" fillcolor="#FFF9C4" peripheries=2 fontsize=10];
            "1262" [label=<select <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>Select</B><BR/>[?, 1]> shape=box style="filled,rounded" fillcolor="#FFF9C4" peripheries=2 fontsize=10];
            "1263" [label=<mat_mul <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>MatMul</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" peripheries=2 fontsize=10];
            "1264" [label=<mat_mul <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>MatMul</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" peripheries=2 fontsize=10];
            "1265" [label=<add <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>Add</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" peripheries=2 fontsize=10];
            "1266" [label=<add <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>Add</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" peripheries=2 fontsize=10];
            "1267" [label=<sigmoid <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>Sigmoid</B><BR/>[?, 16]> shape=diamond style=filled fillcolor="#FFE0B2" peripheries=2 fontsize=10];
            "1268" [label=<mat_mul <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>MatMul</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" peripheries=2 fontsize=10];
            "1269" [label=<mat_mul <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>MatMul</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" peripheries=2 fontsize=10];
            "1270" [label=<add <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>Add</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" peripheries=2 fontsize=10];
            "1271" [label=<add <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>Add</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" peripheries=2 fontsize=10];
            "1272" [label=<sigmoid <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>Sigmoid</B><BR/>[?, 16]> shape=diamond style=filled fillcolor="#FFE0B2" peripheries=2 fontsize=10];
            "1273" [label=<mat_mul <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>MatMul</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" peripheries=2 fontsize=10];
            "1274" [label=<mat_mul <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>MatMul</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" peripheries=2 fontsize=10];
            "1275" [label=<multiply <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>Multiply</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" peripheries=2 fontsize=10];
            "1276" [label=<add <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>Add</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" peripheries=2 fontsize=10];
            "1277" [label=<add <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>Add</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" peripheries=2 fontsize=10];
            "1278" [label=<tanh <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>Tanh</B><BR/>[?, 16]> shape=diamond style=filled fillcolor="#FFE0B2" peripheries=2 fontsize=10];
            "1279" [label=<subtract <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>Subtract</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" peripheries=2 fontsize=10];
            "1280" [label=<multiply <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>Multiply</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" peripheries=2 fontsize=10];
            "1281" [label=<add <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>Add</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" peripheries=2 fontsize=10];
        }
            "1260" [label=<input <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>SmartInput</B><BR/>[?, 4-12, 1]> shape=ellipse style=filled fillcolor="#E0E0E0" peripheries=2 fontsize=10];
    }

    "1504" [label=<target <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>TargetInput</B><BR/>[?, 2]> shape=ellipse style=filled fillcolor="#FFE0B2" peripheries=2 fontsize=10];
    "1505" [label=<softmax_ce <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>SoftmaxCE</B><BR/>[?, 1]> shape=octagon style=filled fillcolor="#FFEBEE" peripheries=2 fontsize=10];

    "1260" -> "1262";
    "1262" -> "1263";
    "1" -> "1263";
    "1261" -> "1264";
    "2" -> "1264";
    "1263" -> "1265";
    "1264" -> "1265";
    "1265" -> "1266";
    "3" -> "1266";
    "1266" -> "1267";
    "1262" -> "1268";
    "4" -> "1268";
    "1261" -> "1269";
    "5" -> "1269";
    "1268" -> "1270";
    "1269" -> "1270";
    "1270" -> "1271";
    "6" -> "1271";
    "1271" -> "1272";
    "1262" -> "1273";
    "7" -> "1273";
    "1261" -> "1274";
    "8" -> "1274";
    "1267" -> "1275";
    "1274" -> "1275";
    "1273" -> "1276";
    "1275" -> "1276";
    "1276" -> "1277";
    "9" -> "1277";
    "1277" -> "1278";
    "1261" -> "1279";
    "1278" -> "1279";
    "1272" -> "1280";
    "1279" -> "1280";
    "1278" -> "1281";
    "1280" -> "1281";
    "1281" -> "1502" [color="#E67E22" label=<t=3~11> fontcolor="#E67E22" fontsize=9];
    "10" -> "1502";
    "1502" -> "1503";
    "11" -> "1503";
    "1503" -> "1505";
    "1504" -> "1505";
    "1260" -> "1261" [style=dashed color="#E67E22" label=<t=0> fontcolor="#E67E22" fontsize=9];
    "1281" -> "1261" [style=dashed color="#E67E22" label=<t=0~(2~10)> fontcolor="#E67E22" fontsize=9 constraint=false];
}
