digraph Model {
    rankdir=TB;
    newrank=true;
    splines=polyline;
    node [fontname="Microsoft YaHei,SimHei,Arial"];
    edge [fontname="Microsoft YaHei,SimHei,Arial"];

    subgraph cluster_ParityRNN {
        label=<<B>ParityRNN</B><BR/><FONT POINT-SIZE="9">Model: 57 nodes</FONT>>;
        style=filled;
        fillcolor="#FFECB340";
        fontname="Microsoft YaHei,SimHei,Arial";
        fontsize=11;
        margin=12;
        subgraph cluster_ParityRNN_fc {
            label=<<B>fc</B><BR/><FONT POINT-SIZE="8">Linear: [?, 16] → [?, 2]</FONT>>;
            style=filled;
            fillcolor="#E3F2FD80";
            fontname="Microsoft YaHei,SimHei,Arial";
            fontsize=10;
            margin=8;
            "4" [label=<fc_W<BR/><B>Parameter</B><BR/>[16, 2]<BR/>(32 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
            "5" [label=<fc_b<BR/><B>Parameter</B><BR/>[1, 2]<BR/>(2 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
            "56" [label=<mat_mul_17<BR/><B>MatMul</B><BR/>[?, 2]> shape=box style="filled,rounded" fillcolor="#FFFDE7" fontsize=10];
            "57" [label=<add_17<BR/><B>Add</B><BR/>[?, 2]> shape=box style="filled,rounded" fillcolor="#FFFDE7" fontsize=10];
        }
        subgraph cluster_ParityRNN_rnn {
            label=<<B>rnn</B><BR/><FONT POINT-SIZE="8">RNN: [?, 1] → [?, 16]</FONT>>;
            style="filled,bold";
            peripheries=3;
            penwidth=2;
            fillcolor="#E8F5E980";
            fontname="Microsoft YaHei,SimHei,Arial";
            fontsize=10;
            margin=8;
            "1" [label=<rnn_W_ih<BR/><B>Parameter</B><BR/>[1, 16]<BR/>(16 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
            "2" [label=<rnn_W_hh<BR/><B>Parameter</B><BR/>[16, 16]<BR/>(256 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
            "3" [label=<rnn_b_h<BR/><B>Parameter</B><BR/>[1, 16]<BR/>(16 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
            "7" [label=<zeros_like <FONT COLOR="#E67E22">×1</FONT><BR/><B>ZerosLike</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" fontsize=10];
            "8" [label=<select <FONT COLOR="#E67E22">×8</FONT><BR/><B>Select</B><BR/>[?, 1]> shape=box style="filled,rounded" fillcolor="#FFF9C4" fontsize=10];
            "9" [label=<mat_mul <FONT COLOR="#E67E22">×8</FONT><BR/><B>MatMul</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" fontsize=10];
            "10" [label=<mat_mul <FONT COLOR="#E67E22">×8</FONT><BR/><B>MatMul</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" fontsize=10];
            "11" [label=<add <FONT COLOR="#E67E22">×8</FONT><BR/><B>Add</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" fontsize=10];
            "12" [label=<add <FONT COLOR="#E67E22">×8</FONT><BR/><B>Add</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" fontsize=10];
            "13" [label=<tanh <FONT COLOR="#E67E22">×8</FONT><BR/><B>Tanh</B><BR/>[?, 16]> shape=diamond style=filled fillcolor="#FFE0B2" fontsize=10];
        }
        "6" [label=<input_1<BR/><B>SmartInput</B><BR/>[?, 8, 1]> shape=ellipse style=filled fillcolor="#E0E0E0" fontsize=10];
    }

    "58" [label=<target_1<BR/><B>TargetInput</B><BR/>[?, 2]> shape=ellipse style=filled fillcolor="#FFE0B2" fontsize=10];
    "59" [label=<softmax_ce_1<BR/><B>SoftmaxCE</B><BR/>[?, 1]> shape=octagon style=filled fillcolor="#FFEBEE" fontsize=10];

    "6" -> "8";
    "8" -> "9";
    "1" -> "9";
    "7" -> "10";
    "2" -> "10";
    "9" -> "11";
    "10" -> "11";
    "11" -> "12";
    "3" -> "12";
    "12" -> "13";
    "13" -> "56";
    "4" -> "56";
    "56" -> "57";
    "5" -> "57";
    "57" -> "59";
    "58" -> "59";
    "6" -> "7" [style=dashed color="#E67E22" label=<t=0 <FONT COLOR="#E67E22">(×1)</FONT>> fontcolor="#E67E22" fontsize=9];
    "13" -> "7" [style=dashed color="#E67E22" label=<t&gt;0 <FONT COLOR="#E67E22">(×7)</FONT>> fontcolor="#E67E22" fontsize=9 constraint=false];
}
