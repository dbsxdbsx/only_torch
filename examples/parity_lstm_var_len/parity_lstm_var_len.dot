digraph Model {
    rankdir=TB;
    newrank=true;
    splines=ortho;
    node [fontname="Microsoft YaHei,SimHei,Arial"];
    edge [fontname="Microsoft YaHei,SimHei,Arial"];

    subgraph cluster_ParityLSTM {
        label=<<B>ParityLSTM</B><BR/><FONT POINT-SIZE="9">Model: 331 nodes</FONT>>;
        style=filled;
        fillcolor="#FFECB340";
        fontname="Microsoft YaHei,SimHei,Arial";
        fontsize=11;
        margin=12;
        subgraph cluster_ParityLSTM_fc {
            label=<<B>fc</B><BR/><FONT POINT-SIZE="8">Linear: [?, 16] → [?, 2]</FONT>>;
            style=filled;
            fillcolor="#E3F2FD80";
            fontname="Microsoft YaHei,SimHei,Arial";
            fontsize=10;
            margin=8;
            "13" [label=<fc_W<BR/><B>Parameter</B><BR/>[16, 2]<BR/>(32 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
            "14" [label=<fc_b<BR/><B>Parameter</B><BR/>[1, 2]<BR/>(2 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
            "1946" [label=<mat_mul <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>MatMul</B><BR/>[?, 2]> shape=box style="filled,rounded" fillcolor="#FFFDE7" peripheries=2 fontsize=10];
            "1947" [label=<add <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>Add</B><BR/>[?, 2]> shape=box style="filled,rounded" fillcolor="#FFFDE7" peripheries=2 fontsize=10];
        }
        subgraph cluster_ParityLSTM_lstm {
            label=<<B>lstm</B><BR/><FONT POINT-SIZE="8">LSTM: [?, 1] → [?, 16]</FONT>>;
            style="filled,bold";
            peripheries=3;
            penwidth=2;
            fillcolor="#E8F5E980";
            fontname="Microsoft YaHei,SimHei,Arial";
            fontsize=10;
            margin=8;
            "1" [label=<lstm_W_ii<BR/><B>Parameter</B><BR/>[1, 16]<BR/>(16 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
            "2" [label=<lstm_W_hi<BR/><B>Parameter</B><BR/>[16, 16]<BR/>(256 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
            "3" [label=<lstm_b_i<BR/><B>Parameter</B><BR/>[1, 16]<BR/>(16 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
            "4" [label=<lstm_W_if<BR/><B>Parameter</B><BR/>[1, 16]<BR/>(16 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
            "5" [label=<lstm_W_hf<BR/><B>Parameter</B><BR/>[16, 16]<BR/>(256 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
            "6" [label=<lstm_b_f<BR/><B>Parameter</B><BR/>[1, 16]<BR/>(16 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
            "7" [label=<lstm_W_ig<BR/><B>Parameter</B><BR/>[1, 16]<BR/>(16 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
            "8" [label=<lstm_W_hg<BR/><B>Parameter</B><BR/>[16, 16]<BR/>(256 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
            "9" [label=<lstm_b_g<BR/><B>Parameter</B><BR/>[1, 16]<BR/>(16 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
            "10" [label=<lstm_W_io<BR/><B>Parameter</B><BR/>[1, 16]<BR/>(16 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
            "11" [label=<lstm_W_ho<BR/><B>Parameter</B><BR/>[16, 16]<BR/>(256 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
            "12" [label=<lstm_b_o<BR/><B>Parameter</B><BR/>[1, 16]<BR/>(16 params)> shape=box style=filled fillcolor="#E8F5E9" fontsize=10];
            "1632" [label=<zeros_like <FONT COLOR="#E67E22">×1</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>ZerosLike</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" peripheries=2 fontsize=10];
            "1633" [label=<zeros_like <FONT COLOR="#E67E22">×1</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>ZerosLike</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" peripheries=2 fontsize=10];
            "1634" [label=<select <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>Select</B><BR/>[?, 1]> shape=box style="filled,rounded" fillcolor="#FFF9C4" peripheries=2 fontsize=10];
            "1635" [label=<mat_mul <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>MatMul</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" peripheries=2 fontsize=10];
            "1636" [label=<mat_mul <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>MatMul</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" peripheries=2 fontsize=10];
            "1637" [label=<add <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>Add</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" peripheries=2 fontsize=10];
            "1638" [label=<add <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>Add</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" peripheries=2 fontsize=10];
            "1639" [label=<sigmoid <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>Sigmoid</B><BR/>[?, 16]> shape=diamond style=filled fillcolor="#FFE0B2" peripheries=2 fontsize=10];
            "1640" [label=<mat_mul <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>MatMul</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" peripheries=2 fontsize=10];
            "1641" [label=<mat_mul <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>MatMul</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" peripheries=2 fontsize=10];
            "1642" [label=<add <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>Add</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" peripheries=2 fontsize=10];
            "1643" [label=<add <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>Add</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" peripheries=2 fontsize=10];
            "1644" [label=<sigmoid <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>Sigmoid</B><BR/>[?, 16]> shape=diamond style=filled fillcolor="#FFE0B2" peripheries=2 fontsize=10];
            "1645" [label=<mat_mul <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>MatMul</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" peripheries=2 fontsize=10];
            "1646" [label=<mat_mul <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>MatMul</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" peripheries=2 fontsize=10];
            "1647" [label=<add <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>Add</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" peripheries=2 fontsize=10];
            "1648" [label=<add <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>Add</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" peripheries=2 fontsize=10];
            "1649" [label=<tanh <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>Tanh</B><BR/>[?, 16]> shape=diamond style=filled fillcolor="#FFE0B2" peripheries=2 fontsize=10];
            "1650" [label=<mat_mul <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>MatMul</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" peripheries=2 fontsize=10];
            "1651" [label=<mat_mul <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>MatMul</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" peripheries=2 fontsize=10];
            "1652" [label=<add <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>Add</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" peripheries=2 fontsize=10];
            "1653" [label=<add <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>Add</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" peripheries=2 fontsize=10];
            "1654" [label=<sigmoid <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>Sigmoid</B><BR/>[?, 16]> shape=diamond style=filled fillcolor="#FFE0B2" peripheries=2 fontsize=10];
            "1655" [label=<multiply <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>Multiply</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" peripheries=2 fontsize=10];
            "1656" [label=<multiply <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>Multiply</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" peripheries=2 fontsize=10];
            "1657" [label=<add <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>Add</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" peripheries=2 fontsize=10];
            "1658" [label=<tanh <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>Tanh</B><BR/>[?, 16]> shape=diamond style=filled fillcolor="#FFE0B2" peripheries=2 fontsize=10];
            "1659" [label=<multiply <FONT COLOR="#E67E22">×4-12</FONT> <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>Multiply</B><BR/>[?, 16]> shape=box style="filled,rounded" fillcolor="#FFF9C4" peripheries=2 fontsize=10];
        }
        "1631" [label=<input <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>SmartInput</B><BR/>[?, 4-12, 1]> shape=ellipse style=filled fillcolor="#E0E0E0" peripheries=2 fontsize=10];
    }

    "1948" [label=<target <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>TargetInput</B><BR/>[?, 2]> shape=ellipse style=filled fillcolor="#FFE0B2" peripheries=2 fontsize=10];
    "1949" [label=<softmax_ce <FONT COLOR="#1565C0">(×9)</FONT><BR/><B>SoftmaxCE</B><BR/>[?, 1]> shape=octagon style=filled fillcolor="#FFEBEE" peripheries=2 fontsize=10];

    "1631" -> "1634";
    "1634" -> "1635";
    "1" -> "1635";
    "1632" -> "1636";
    "2" -> "1636";
    "1635" -> "1637";
    "1636" -> "1637";
    "1637" -> "1638";
    "3" -> "1638";
    "1638" -> "1639";
    "1634" -> "1640";
    "4" -> "1640";
    "1632" -> "1641";
    "5" -> "1641";
    "1640" -> "1642";
    "1641" -> "1642";
    "1642" -> "1643";
    "6" -> "1643";
    "1643" -> "1644";
    "1634" -> "1645";
    "7" -> "1645";
    "1632" -> "1646";
    "8" -> "1646";
    "1645" -> "1647";
    "1646" -> "1647";
    "1647" -> "1648";
    "9" -> "1648";
    "1648" -> "1649";
    "1634" -> "1650";
    "10" -> "1650";
    "1632" -> "1651";
    "11" -> "1651";
    "1650" -> "1652";
    "1651" -> "1652";
    "1652" -> "1653";
    "12" -> "1653";
    "1653" -> "1654";
    "1644" -> "1655";
    "1633" -> "1655";
    "1639" -> "1656";
    "1649" -> "1656";
    "1655" -> "1657";
    "1656" -> "1657";
    "1657" -> "1658";
    "1654" -> "1659";
    "1658" -> "1659";
    "1659" -> "1946";
    "13" -> "1946";
    "1946" -> "1947";
    "14" -> "1947";
    "1947" -> "1949";
    "1948" -> "1949";
    "1631" -> "1632" [style=dashed color="#E67E22" label=<t=0 <FONT COLOR="#E67E22">(×1)</FONT>> fontcolor="#E67E22" fontsize=9];
    "1659" -> "1632" [style=dashed color="#E67E22" label=<t&gt;0 <FONT COLOR="#E67E22">(×3-11)</FONT>> fontcolor="#E67E22" fontsize=9 constraint=false];
    "1631" -> "1633" [style=dashed color="#E67E22" label=<t=0 <FONT COLOR="#E67E22">(×1)</FONT>> fontcolor="#E67E22" fontsize=9];
    "1657" -> "1633" [style=dashed color="#E67E22" label=<t&gt;0 <FONT COLOR="#E67E22">(×3-11)</FONT>> fontcolor="#E67E22" fontsize=9 constraint=false];
    { rank=same; "1632"; "1633" }
}
